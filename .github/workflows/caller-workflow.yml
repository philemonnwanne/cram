name: Call Terraform MOC ğŸ’£
run-name: Made by ${{ github.actor }} ğŸ¤–
on:
  workflow_dispatch:
  push:
    branches:
      - 'main'

defaults:
  run:
    working-directory: "./azure"

permissions:
  id-token: write # required for requesting the JWT
  contents: read # required for actions/checkout
  pull-requests: write

jobs:
  infracost_job:
    name: ğŸ¤” Pre-Determine Infrastructure Cost ğŸ’°
    uses: philemonnwanne/cram/.github/workflows/infracost.yml@main

  create_job:
    name: â›…ï¸ Create AZURE App ğŸ•‹
    needs: infracost_job
    # if: ${{ success() }}
    uses: philemonnwanne/cram/.github/workflows/terraform-create.yml@main

  destroy_job:
    name: ğŸ’£ Destroy AZURE App ğŸ’¥
    needs: create_job
    # if: ${{ success() }}
    uses: philemonnwanne/cram/.github/workflows/terraform-destroy.yml@main
