name: Call Terraform MOC 💣
run-name: Made by ${{ github.actor }} 🤖
on:
  workflow_dispatch:
  push:
    branches:
      - 'main'

defaults:
  run:
    working-directory: "./azure"

permissions:
  id-token: write # required for requesting the JWT
  contents: read # required for actions/checkout
  pull-requests: write

jobs:
  infracost_job:
    name: 🤔 Pre-Determine Infrastructure Cost 💰
    uses: philemonnwanne/cram/.github/workflows/infracost.yml@main

  create_job:
    name: ⛅️ Create AZURE App 🕋
    needs: infracost_job
    # if: ${{ success() }}
    uses: philemonnwanne/cram/.github/workflows/terraform-create.yml@main

  destroy_job:
    name: 💣 Destroy AZURE App 💥
    needs: create_job
    # if: ${{ success() }}
    uses: philemonnwanne/cram/.github/workflows/terraform-destroy.yml@main
