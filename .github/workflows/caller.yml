name: 👨🏾‍🎤 terraform MOC 🧌
run-name: action by ${{ github.actor }} 🧌
on:
  workflow_dispatch:
  push:
    branches:
      - "main"

permissions:
  id-token: write # required for requesting the JWT
  contents: read # required for actions/checkout
  pull-requests: write

jobs:
  # static_test:
  #   name:
  #   # needs: infracost_job
  #   # if: ${{ failure() }}
  #   uses: philemonnwanne/cram/.github/workflows/static-test.yml@main
  #   secrets: inherit

  build:
    name:
    # needs: infracost_job
    # if: ${{ failure() }}
    needs: static_test
    uses: philemonnwanne/cram/.github/workflows/build.yml@main
    secrets: inherit

  # integration_test:
  #   name: Run Integration Tests
  #   needs: [static_test, build]
  #   uses: philemonnwanne/cram/.github/workflows/integration-test.yml@main
  #   secrets: inherit

  # deploy_stage:
  #   name: Deploy to Staging Environment 🕋
  #   needs: [build, integration_test]
  #   uses: philemonnwanne/cram/.github/workflows/deploy-stage.yml@main
  #   secrets: inherit

  # deploy_prod:
  #   name: ⛅️ Deploy to Live Environment
  #   needs: deploy_stage
  #   uses: philemonnwanne/cram.github/workflows/deploy-prod.yml@main
  #   secrets: inherit

  # deploy:
  #   name: Deploy to Staging and Production Environments 🕋
  #   needs: integration_test
  #   uses: philemonnwanne/cram/.github/workflows/deploy.yml@main
  #   secrets: inherit
